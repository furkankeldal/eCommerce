server:
  port: 8090

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      routes:
        # API Routes (Prefixed)
        - id: user-service
          uri: http://${USER_SERVICE_HOST:user-service}:9011
          predicates:
            - Path=/user-service/**
          filters:
            - RewritePath=/user-service/(?<targetPath>.*), /$\{targetPath}
            - PreserveHostHeader
        - id: product-service
          uri: http://${PRODUCT_SERVICE_HOST:product-service}:9012
          predicates:
            - Path=/product-service/**
          filters:
            - RewritePath=/product-service/(?<targetPath>.*), /$\{targetPath}
            - PreserveHostHeader
        - id: stock-service
          uri: http://${STOCK_SERVICE_HOST:stock-service}:9013
          predicates:
            - Path=/stock-service/**
          filters:
            - RewritePath=/stock-service/(?<targetPath>.*), /$\{targetPath}
            - PreserveHostHeader
        - id: order-service
          uri: http://${ORDER_SERVICE_HOST:order-service}:9014
          predicates:
            - Path=/order-service/**
          filters:
            - RewritePath=/order-service/(?<targetPath>.*), /$\{targetPath}
            - PreserveHostHeader
        - id: payment-service
          uri: http://${PAYMENT_SERVICE_HOST:payment-service}:9015
          predicates:
            - Path=/payment-service/**
          filters:
            - RewritePath=/payment-service/(?<targetPath>.*), /$\{targetPath}
            - PreserveHostHeader
        
# Swagger/OpenAPI Configuration
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    urls:
      - url: /user-service/v3/api-docs
        name: User Service
      - url: /product-service/v3/api-docs
        name: Product Service
      - url: /stock-service/v3/api-docs
        name: Stock Service
      - url: /order-service/v3/api-docs
        name: Order Service
      - url: /payment-service/v3/api-docs
        name: Payment Service
    urls-primary-name: API Gateway Service

# Service URLs for Swagger Config
user:
  service:
    url: ${USER_SERVICE_URL:http://user-service:9011}
product:
  service:
    url: ${PRODUCT_SERVICE_URL:http://product-service:9012}
stock:
  service:
    url: ${STOCK_SERVICE_URL:http://stock-service:9013}
order:
  service:
    url: ${ORDER_SERVICE_URL:http://order-service:9014}
payment:
  service:
    url: ${PAYMENT_SERVICE_URL:http://payment-service:9015}

logging:
  level:
    org.springframework.cloud.gateway: INFO
    org.springframework.web: INFO
    com.eticaret: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

